{"ast":null,"code":"var _jsxFileName = \"E:\\\\NETRA PROJECT\\\\Netra\\\\netra\\\\src\\\\pages\\\\RUL\\\\RulLife.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useCallback, useEffect } from \"react\";\nimport Navigation from \"../../components/navigation/Navigation\";\nimport styles from \"./rul.module.css\";\nimport UserSelection from \"../../ui/userSelection/userSelection\";\nimport { Button, makeStyles, TextField } from \"@material-ui/core\";\nimport { Autocomplete } from \"@material-ui/lab\";\nimport TreeComponent from \"../../components/sortableTree/SortableTree\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { treeDataActions } from \"../../store/TreeDataStore\";\nimport AutoSelect from \"../../ui/Form/AutoSelect\";\nimport { useDropzone } from \"react-dropzone\";\nimport CustomizedSnackbars from \"../../ui/CustomSnackBar\";\nimport RULPredictor from \"./RULPredictor\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles({\n  buttons: {\n    margin: 5,\n    minWidth: 170,\n    float: \"right\"\n  },\n  align: {\n    marginBottom: 10\n  }\n});\n\nconst RulLife = () => {\n  _s();\n\n  var _matchingItems$;\n\n  const [paramOptions, setParamOptions] = useState([]);\n  const [selectedParameterName, setParameterName] = useState(\"\");\n  const [selectedEqName, setEquipmentName] = useState([]);\n  const [para, setPara] = useState([]);\n  const [prevrul, setPrevrul] = useState();\n  const [isRulOpen, setRulOpen] = useState(false);\n  const [uploadedFile, setUploadedFile] = useState(null);\n  const [P, setP] = useState(0);\n  const [F, setF] = useState(0); // Function to handle file upload\n\n  const handleFileUpload = file => {\n    setUploadedFile(file);\n    console.log(uploadedFile);\n    const formData = new FormData();\n    formData.append(\"file\", file);\n    fetch(\"/csv_upload\", {\n      method: \"POST\",\n      body: formData\n    }).then(response => response.text()).then(data => {\n      console.log(data); // Response from the server\n    }).catch(error => {\n      console.error(\"Fetch Error:\", error);\n    });\n  }; // Dropzone configuration\n\n\n  const {\n    getRootProps,\n    getInputProps\n  } = useDropzone({\n    onDrop: acceptedFiles => handleFileUpload(acceptedFiles[0]),\n    accept: \".csv\",\n    // Accept only CSV files, you can modify this to accept other file types\n    multiple: false // Allow only one file to be uploaded at a time\n\n  });\n  const dispatch = useDispatch();\n  const currentSelection = useSelector(state => state.userSelection.currentSelection);\n  let fData = useSelector(state => state.treeData.treeData);\n  console.log(selectedParameterName);\n  const sData = useSelector(state => state.userSelection.componentsData);\n  const currentEquipmentName = currentSelection[\"equipmentName\"];\n  const matchingItems = sData.filter(item => item.name === currentEquipmentName);\n  const matchingId = (_matchingItems$ = matchingItems[0]) === null || _matchingItems$ === void 0 ? void 0 : _matchingItems$.id;\n\n  const onLoadTreeStructure = () => {\n    const payload = {\n      system: currentSelection[\"equipmentName\"],\n      ship_name: currentSelection[\"shipName\"]\n    };\n\n    if (matchingId) {\n      payload.component_id = matchingId;\n    }\n\n    console.log(payload);\n    fetch(\"/fetch_system\", {\n      method: \"POST\",\n      body: JSON.stringify(payload),\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\"\n      }\n    }).then(res => res.json()).then(d => {\n      console.log(d);\n      let treeD = d[\"treeD\"];\n      let failureModes = d[\"failureMode\"];\n      console.log(failureModes);\n      dispatch(treeDataActions.setTreeData({\n        treeData: treeD\n      }));\n      dispatch(treeDataActions.setFailureModes(failureModes));\n    });\n  };\n\n  const handlePrevRul = (e, p) => {\n    e.preventDefault();\n    console.log(\"matching\", matchingItems[0]);\n    console.log(typeof parameter, \"abcd\");\n    fetch(\"/prev_rul\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        parameter: p\n      })\n    }).then(res => res.json()).then(data => {\n      setPrevrul(data);\n      setRulOpen(true);\n      console.log(\"RUL DATA\", data);\n    }).catch(error => {\n      console.error(\"Fetch Error:\", error);\n      throw error;\n    });\n    fetch(\"/get_pf\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\"\n      },\n      body: JSON.stringify({\n        equipment_id: selectedEqName === null || selectedEqName === void 0 ? void 0 : selectedEqName.id,\n        name: selectedParameterName\n      })\n    }).then(res => {\n      return res.json();\n    }).then(data => {\n      console.log(data);\n      setP(data[0].P);\n      setF(data[0].F);\n      console.log(P, F);\n    }).catch(error => {// Handle fetch error\n    });\n  };\n\n  console.log(prevrul);\n  useEffect(() => {\n    fetch(\"/cm_dashboard\", {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\"\n      }\n    }).then(res => {\n      return res.json();\n    }).then(data => {\n      const params = data[\"parameters\"];\n      console.log(\"luck\", params);\n      setPara(params);\n    }).catch(error => {// Handle fetch error\n    });\n  }, [selectedEqName]);\n  useEffect(() => {\n    console.log(\"s\");\n    const selectedEqNameArray = Object.values(selectedEqName).map(equipment => equipment);\n    console.log(selectedEqNameArray);\n    const filteredArray = para.filter(item => selectedEqNameArray.includes(item.equipment_id));\n    console.log(filteredArray, \"nafkja\");\n    const filteredNames = filteredArray.map(item => item.name);\n    setParamOptions(filteredNames);\n  }, [selectedEqName, para]); // Snackbar\n\n  const [SnackBarMessage, setSnackBarMessage] = useState({\n    severity: \"error\",\n    message: \"This is awesome\",\n    showSnackBar: false\n  });\n\n  const onHandleSnackClose = () => {\n    setSnackBarMessage({\n      severity: \"error\",\n      message: \"Please Add Systemss\",\n      showSnackBar: false\n    });\n  };\n\n  const classes = useStyles();\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Navigation, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.userSelection,\n      children: [/*#__PURE__*/_jsxDEV(UserSelection, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          className: classes.buttons,\n          onClick: onLoadTreeStructure,\n          variant: \"contained\",\n          color: \"primary\",\n          children: \"Submit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.content,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.tree,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.treeChild,\n          children: /*#__PURE__*/_jsxDEV(TreeComponent, {\n            height: \"600px\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 237,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.rightSection,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.userSelection,\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.selectContainer,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.selectC,\n              children: [\"Select Component\", /*#__PURE__*/_jsxDEV(AutoSelect, {\n                fields: fData,\n                onChange: (e, value) => setEquipmentName(value),\n                value: selectedEqName\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 245,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 243,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [\"Select Parameter\", /*#__PURE__*/_jsxDEV(Autocomplete, {\n                className: styles.SelectP,\n                id: \"tags-standard\",\n                options: paramOptions // getOptionLabel={(option) => option.name}\n                ,\n                value: selectedParameterName,\n                onChange: (e, value) => setParameterName(value),\n                renderInput: params => /*#__PURE__*/_jsxDEV(TextField, { ...params,\n                  InputProps: { ...params.InputProps,\n                    disableUnderline: true\n                  },\n                  variant: \"standard\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 261,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 253,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 251,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", { ...getRootProps(),\n              children: [/*#__PURE__*/_jsxDEV(\"input\", { ...getInputProps()\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 273,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                className: classes.buttons,\n                variant: \"contained\",\n                color: \"primary\",\n                children: \"Upload File\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 274,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 272,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.importBtnContainer,\n              children: /*#__PURE__*/_jsxDEV(Button, {\n                className: classes.buttons,\n                variant: \"contained\",\n                color: \"primary\",\n                onClick: e => handlePrevRul(e, selectedParameterName),\n                children: \"Calculate RUL\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 283,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 282,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 242,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 11\n        }, this), isRulOpen && /*#__PURE__*/_jsxDEV(RULPredictor, {\n          selectedEqName: selectedEqName,\n          prevRul: prevrul,\n          P: P,\n          F: F\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 295,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 7\n    }, this), SnackBarMessage.showSnackBar && /*#__PURE__*/_jsxDEV(CustomizedSnackbars, {\n      message: SnackBarMessage,\n      onHandleClose: onHandleSnackClose\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 301,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n};\n\n_s(RulLife, \"puHAn3s7isEQ61ff6hRiXCUSX/0=\", false, function () {\n  return [useDropzone, useDispatch, useSelector, useSelector, useSelector, useStyles];\n});\n\n_c = RulLife;\nexport default RulLife;\n\nvar _c;\n\n$RefreshReg$(_c, \"RulLife\");","map":{"version":3,"sources":["E:/NETRA PROJECT/Netra/netra/src/pages/RUL/RulLife.js"],"names":["React","useState","useCallback","useEffect","Navigation","styles","UserSelection","Button","makeStyles","TextField","Autocomplete","TreeComponent","useSelector","useDispatch","treeDataActions","AutoSelect","useDropzone","CustomizedSnackbars","RULPredictor","useStyles","buttons","margin","minWidth","float","align","marginBottom","RulLife","paramOptions","setParamOptions","selectedParameterName","setParameterName","selectedEqName","setEquipmentName","para","setPara","prevrul","setPrevrul","isRulOpen","setRulOpen","uploadedFile","setUploadedFile","P","setP","F","setF","handleFileUpload","file","console","log","formData","FormData","append","fetch","method","body","then","response","text","data","catch","error","getRootProps","getInputProps","onDrop","acceptedFiles","accept","multiple","dispatch","currentSelection","state","userSelection","fData","treeData","sData","componentsData","currentEquipmentName","matchingItems","filter","item","name","matchingId","id","onLoadTreeStructure","payload","system","ship_name","component_id","JSON","stringify","headers","Accept","res","json","d","treeD","failureModes","setTreeData","setFailureModes","handlePrevRul","e","p","preventDefault","parameter","equipment_id","params","selectedEqNameArray","Object","values","map","equipment","filteredArray","includes","filteredNames","SnackBarMessage","setSnackBarMessage","severity","message","showSnackBar","onHandleSnackClose","classes","content","tree","treeChild","rightSection","selectContainer","selectC","value","SelectP","InputProps","disableUnderline","importBtnContainer"],"mappings":"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","sourcesContent":["import React, { useState, useCallback, useEffect } from \"react\";\r\nimport Navigation from \"../../components/navigation/Navigation\";\r\nimport styles from \"./rul.module.css\";\r\nimport UserSelection from \"../../ui/userSelection/userSelection\";\r\nimport { Button, makeStyles, TextField } from \"@material-ui/core\";\r\nimport { Autocomplete } from \"@material-ui/lab\";\r\nimport TreeComponent from \"../../components/sortableTree/SortableTree\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { treeDataActions } from \"../../store/TreeDataStore\";\r\nimport AutoSelect from \"../../ui/Form/AutoSelect\";\r\nimport { useDropzone } from \"react-dropzone\";\r\nimport CustomizedSnackbars from \"../../ui/CustomSnackBar\";\r\nimport RULPredictor from \"./RULPredictor\";\r\n\r\nconst useStyles = makeStyles({\r\n  buttons: {\r\n    margin: 5,\r\n    minWidth: 170,\r\n    float: \"right\",\r\n  },\r\n  align: {\r\n    marginBottom: 10,\r\n  },\r\n});\r\n\r\nconst RulLife = () => {\r\n  const [paramOptions, setParamOptions] = useState([]);\r\n  const [selectedParameterName, setParameterName] = useState(\"\");\r\n  const [selectedEqName, setEquipmentName] = useState([]);\r\n  const [para, setPara] = useState([]);\r\n  const [prevrul, setPrevrul] = useState();\r\n  const [isRulOpen, setRulOpen] = useState(false);\r\n  const [uploadedFile, setUploadedFile] = useState(null);\r\n  const [P, setP] = useState(0);\r\n  const [F, setF] = useState(0);\r\n\r\n  // Function to handle file upload\r\n  const handleFileUpload = (file) => {\r\n    setUploadedFile(file);\r\n    console.log(uploadedFile);\r\n    const formData = new FormData();\r\n    formData.append(\"file\", file);\r\n\r\n    fetch(\"/csv_upload\", {\r\n      method: \"POST\",\r\n      body: formData,\r\n    })\r\n      .then((response) => response.text())\r\n      .then((data) => {\r\n        console.log(data); // Response from the server\r\n      })\r\n      .catch((error) => {\r\n        console.error(\"Fetch Error:\", error);\r\n      });\r\n  };\r\n\r\n  // Dropzone configuration\r\n  const { getRootProps, getInputProps } = useDropzone({\r\n    onDrop: (acceptedFiles) => handleFileUpload(acceptedFiles[0]),\r\n    accept: \".csv\", // Accept only CSV files, you can modify this to accept other file types\r\n    multiple: false, // Allow only one file to be uploaded at a time\r\n  });\r\n\r\n  const dispatch = useDispatch();\r\n  const currentSelection = useSelector(\r\n    (state) => state.userSelection.currentSelection\r\n  );\r\n  let fData = useSelector((state) => state.treeData.treeData);\r\n  console.log(selectedParameterName);\r\n  const sData = useSelector((state) => state.userSelection.componentsData);\r\n\r\n  const currentEquipmentName = currentSelection[\"equipmentName\"];\r\n  const matchingItems = sData.filter(item => item.name === currentEquipmentName);\r\n\r\n  const matchingId = matchingItems[0]?.id;\r\n  const onLoadTreeStructure = () => {\r\n    const payload = {\r\n      system: currentSelection[\"equipmentName\"],\r\n      ship_name: currentSelection[\"shipName\"],\r\n    };\r\n\r\n    if (matchingId) {\r\n      payload.component_id = matchingId;\r\n    }\r\n    console.log(payload)\r\n    fetch(\"/fetch_system\", {\r\n      method: \"POST\",\r\n      body: JSON.stringify(payload),\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Accept: \"application/json\",\r\n      },\r\n    })\r\n      .then((res) => res.json())\r\n      .then((d) => {\r\n        console.log(d);\r\n        let treeD = d[\"treeD\"];\r\n        let failureModes = d[\"failureMode\"];\r\n        console.log(failureModes)\r\n        dispatch(\r\n          treeDataActions.setTreeData({\r\n            treeData: treeD,\r\n          }),\r\n        );\r\n        dispatch(\r\n          treeDataActions.setFailureModes(failureModes)\r\n        )\r\n      });\r\n  };\r\n\r\n  const handlePrevRul = (e, p) => {\r\n    e.preventDefault();\r\n    console.log(\"matching\",matchingItems[0])\r\n    console.log(typeof parameter, \"abcd\")\r\n    fetch(\"/prev_rul\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        parameter: p,\r\n      }),\r\n    })\r\n      .then((res) => res.json())\r\n      .then((data) => {\r\n        setPrevrul(data);\r\n        setRulOpen(true);\r\n        console.log(\"RUL DATA\",data);\r\n      })\r\n      .catch((error) => {\r\n        console.error(\"Fetch Error:\", error);\r\n        throw error;\r\n      });\r\n\r\n    fetch(\"/get_pf\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Accept: \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        equipment_id: selectedEqName?.id,\r\n        name: selectedParameterName\r\n      }),\r\n    })\r\n      .then((res) => {\r\n        return res.json();\r\n      })\r\n      .then((data) => {\r\n        console.log(data)\r\n        setP(data[0].P)\r\n        setF(data[0].F)\r\n        console.log(P, F)\r\n        \r\n      })\r\n      .catch((error) => {\r\n        // Handle fetch error\r\n      });\r\n  };\r\n\r\n  console.log(prevrul);\r\n  useEffect(() => {\r\n    fetch(\"/cm_dashboard\", {\r\n      method: \"GET\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Accept: \"application/json\",\r\n      },\r\n    })\r\n      .then((res) => {\r\n        return res.json();\r\n      })\r\n      .then((data) => {\r\n        const params = data[\"parameters\"];\r\n        console.log(\"luck\", params);\r\n        setPara(params);\r\n      })\r\n      .catch((error) => {\r\n        // Handle fetch error\r\n      });\r\n  }, [selectedEqName]);\r\n\r\n  useEffect(() => {\r\n    console.log(\"s\");\r\n    const selectedEqNameArray = Object.values(selectedEqName).map(\r\n      (equipment) => equipment\r\n    );\r\n    console.log(selectedEqNameArray);\r\n\r\n    const filteredArray = para.filter((item) =>\r\n      selectedEqNameArray.includes(item.equipment_id)\r\n    );\r\n\r\n    console.log(filteredArray, \"nafkja\");\r\n\r\n    const filteredNames = filteredArray.map((item) => item.name);\r\n    setParamOptions(filteredNames);\r\n  }, [selectedEqName, para]);\r\n\r\n  // Snackbar\r\n  const [SnackBarMessage, setSnackBarMessage] = useState({\r\n    severity: \"error\",\r\n    message: \"This is awesome\",\r\n    showSnackBar: false,\r\n  });\r\n\r\n  const onHandleSnackClose = () => {\r\n    setSnackBarMessage({\r\n      severity: \"error\",\r\n      message: \"Please Add Systemss\",\r\n      showSnackBar: false,\r\n    });\r\n  };\r\n\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <>\r\n      <Navigation />\r\n      <div className={styles.userSelection}>\r\n        <UserSelection />\r\n        <div>\r\n          <Button\r\n            className={classes.buttons}\r\n            onClick={onLoadTreeStructure}\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n          >\r\n            Submit\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      <div className={styles.content}>\r\n        <div className={styles.tree}>\r\n          <div className={styles.treeChild}>\r\n            <TreeComponent height=\"600px\"></TreeComponent>\r\n          </div>\r\n        </div>\r\n        <div className={styles.rightSection}>\r\n          <div className={styles.userSelection}>\r\n            <div className={styles.selectContainer}>\r\n              <div className={styles.selectC}>\r\n                Select Component\r\n                <AutoSelect\r\n                  fields={fData}\r\n                  onChange={(e, value) => setEquipmentName(value)}\r\n                  value={selectedEqName}\r\n                ></AutoSelect>\r\n              </div>\r\n              <div>\r\n                Select Parameter\r\n                <Autocomplete\r\n                  className={styles.SelectP}\r\n                  id=\"tags-standard\"\r\n                  options={paramOptions}\r\n                  // getOptionLabel={(option) => option.name}\r\n                  value={selectedParameterName}\r\n                  onChange={(e, value) => setParameterName(value)}\r\n                  renderInput={(params) => (\r\n                    <TextField\r\n                      {...params}\r\n                      InputProps={{\r\n                        ...params.InputProps,\r\n                        disableUnderline: true,\r\n                      }}\r\n                      variant=\"standard\"\r\n                    />\r\n                  )}\r\n                />\r\n              </div>\r\n              <div {...getRootProps()}>\r\n                <input {...getInputProps()} />\r\n                <Button\r\n                  className={classes.buttons}\r\n                  variant=\"contained\"\r\n                  color=\"primary\"\r\n                >\r\n                  Upload File\r\n                </Button>\r\n              </div>\r\n              <div className={styles.importBtnContainer}>\r\n                <Button\r\n                  className={classes.buttons}\r\n                  variant=\"contained\"\r\n                  color=\"primary\"\r\n                  onClick={(e) => handlePrevRul(e, selectedParameterName)}\r\n                >\r\n                  Calculate RUL\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          {isRulOpen && (\r\n            <RULPredictor selectedEqName={selectedEqName} prevRul={prevrul} P={P} F={F} />\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {SnackBarMessage.showSnackBar && (\r\n        <CustomizedSnackbars\r\n          message={SnackBarMessage}\r\n          onHandleClose={onHandleSnackClose}\r\n        />\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default RulLife;"]},"metadata":{},"sourceType":"module"}